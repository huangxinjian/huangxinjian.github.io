<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>反射 | HuangXinJian</title>
    <meta name="description" content="If you learn, learn deeply please!">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/H.png">
    
    <link rel="preload" href="/assets/css/0.styles.77838d5e.css" as="style"><link rel="preload" href="/assets/js/app.78cba7d9.js" as="script"><link rel="preload" href="/assets/js/2.b97de27f.js" as="script"><link rel="preload" href="/assets/js/28.aca93b2e.js" as="script"><link rel="prefetch" href="/assets/js/10.5a39f9cf.js"><link rel="prefetch" href="/assets/js/11.fc6bddf2.js"><link rel="prefetch" href="/assets/js/12.da1eaab3.js"><link rel="prefetch" href="/assets/js/13.3e791f4e.js"><link rel="prefetch" href="/assets/js/14.5953a388.js"><link rel="prefetch" href="/assets/js/15.b9e792e3.js"><link rel="prefetch" href="/assets/js/16.14be3228.js"><link rel="prefetch" href="/assets/js/17.d8c48abe.js"><link rel="prefetch" href="/assets/js/18.c1171d86.js"><link rel="prefetch" href="/assets/js/19.687638f3.js"><link rel="prefetch" href="/assets/js/20.dbb7c712.js"><link rel="prefetch" href="/assets/js/21.fcac9d7b.js"><link rel="prefetch" href="/assets/js/22.05c89a82.js"><link rel="prefetch" href="/assets/js/23.6f455ef9.js"><link rel="prefetch" href="/assets/js/24.a5f5dd42.js"><link rel="prefetch" href="/assets/js/25.ddacf5f1.js"><link rel="prefetch" href="/assets/js/26.1dbabccd.js"><link rel="prefetch" href="/assets/js/27.4d3ddddd.js"><link rel="prefetch" href="/assets/js/29.4e592fcf.js"><link rel="prefetch" href="/assets/js/3.8c3b122e.js"><link rel="prefetch" href="/assets/js/30.07e05cf0.js"><link rel="prefetch" href="/assets/js/31.4bc393d7.js"><link rel="prefetch" href="/assets/js/32.5bed9ede.js"><link rel="prefetch" href="/assets/js/33.b1d61159.js"><link rel="prefetch" href="/assets/js/34.27c7f1f1.js"><link rel="prefetch" href="/assets/js/35.17c92a26.js"><link rel="prefetch" href="/assets/js/36.91a5ecf5.js"><link rel="prefetch" href="/assets/js/37.88c250af.js"><link rel="prefetch" href="/assets/js/38.6d72295b.js"><link rel="prefetch" href="/assets/js/39.0e585af1.js"><link rel="prefetch" href="/assets/js/4.ff5f2a88.js"><link rel="prefetch" href="/assets/js/40.80a7f1c2.js"><link rel="prefetch" href="/assets/js/41.defa3efa.js"><link rel="prefetch" href="/assets/js/42.70857ada.js"><link rel="prefetch" href="/assets/js/5.68065b24.js"><link rel="prefetch" href="/assets/js/6.bb2aa06c.js"><link rel="prefetch" href="/assets/js/7.f469350c.js"><link rel="prefetch" href="/assets/js/8.37ca51cf.js"><link rel="prefetch" href="/assets/js/9.68f4fa83.js">
    <link rel="stylesheet" href="/assets/css/0.styles.77838d5e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HuangXinJian</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJS" class="dropdown-title"><span class="title">NodeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nodejs/NodeJS基础/NodeJS介绍.html" class="nav-link">
  NodeJS 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/baseJava/Java 介绍.html" class="nav-link">
  Java 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/frameworkHistory/架构演变历史.html" class="nav-link">
  分布式学习路线
</a></li><li class="dropdown-item"><!----> <a href="/distributed/registerCenter/" class="nav-link">
  注册中心
</a></li><li class="dropdown-item"><!----> <a href="/distributed/messageSystem/" class="nav-link">
  消息系统
</a></li><li class="dropdown-item"><!----> <a href="/distributed/internal/" class="nav-link">
  网络框架
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/RDB/MySQL_Learn/MySQL安装.html" class="nav-link">
  MySQL
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/huangxinjian/huangxinjian.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJS" class="dropdown-title"><span class="title">NodeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nodejs/NodeJS基础/NodeJS介绍.html" class="nav-link">
  NodeJS 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/baseJava/Java 介绍.html" class="nav-link">
  Java 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/frameworkHistory/架构演变历史.html" class="nav-link">
  分布式学习路线
</a></li><li class="dropdown-item"><!----> <a href="/distributed/registerCenter/" class="nav-link">
  注册中心
</a></li><li class="dropdown-item"><!----> <a href="/distributed/messageSystem/" class="nav-link">
  消息系统
</a></li><li class="dropdown-item"><!----> <a href="/distributed/internal/" class="nav-link">
  网络框架
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/RDB/MySQL_Learn/MySQL安装.html" class="nav-link">
  MySQL
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/huangxinjian/huangxinjian.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/java/baseJava/Java 介绍.html" class="sidebar-link">Java 介绍</a></li><li><a href="/java/baseJava/对象与类.html" class="sidebar-link">面向对象</a></li><li><a href="/java/baseJava/继承.html" class="sidebar-link">继承</a></li><li><a href="/java/baseJava/反射.html" class="active sidebar-link">反射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#class-类" class="sidebar-link">Class 类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#获取-class-对象" class="sidebar-link">获取 Class 对象</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#class-forname" class="sidebar-link">Class.forName</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getclass-和-class" class="sidebar-link">getClass() 和 .class</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#获取类的名称" class="sidebar-link">获取类的名称</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#通过class实例创建对象" class="sidebar-link">通过Class实例创建对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#class-常用api" class="sidebar-link">Class 常用API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getfield" class="sidebar-link">getField</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getfiled-name" class="sidebar-link">getFiled(name)</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getdeclaredfields" class="sidebar-link">getDeclaredFields</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getdeclaredfield-name" class="sidebar-link">getDeclaredField(name)</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getmethod" class="sidebar-link">getMethod</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getmethods" class="sidebar-link">getMethods</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getdeclaremethods" class="sidebar-link">getDeclareMethods</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getconstructors" class="sidebar-link">getConstructors</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getdeclaredconstructors" class="sidebar-link">getDeclaredConstructors</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#invoke" class="sidebar-link">invoke 💥</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#field-常用api" class="sidebar-link">Field 常用API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#get-obj" class="sidebar-link">get(obj)</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#set-object-newvalue" class="sidebar-link">set(Object , newValue)</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#method-常用api" class="sidebar-link">Method 常用API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getexceptiontype" class="sidebar-link">getExceptionType</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getreturntype" class="sidebar-link">getReturnType</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getparametertypes" class="sidebar-link">getParameterTypes</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#constructor-常用api" class="sidebar-link">Constructor 常用API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getexceptiontype-2" class="sidebar-link">getExceptionType</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#域、方法、构造器通用-api" class="sidebar-link">域、方法、构造器通用 API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getdeclaringclass" class="sidebar-link">getDeclaringClass</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getname" class="sidebar-link">getName</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#getmodifiers" class="sidebar-link">getModifiers()</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#modifiers-api" class="sidebar-link">Modifiers API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#tostring" class="sidebar-link">toString</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#isxxx" class="sidebar-link">isXXX</a></li></ul></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#accessibleobject-api" class="sidebar-link">AccessibleObject API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#setaccessible-boolean" class="sidebar-link">setAccessible(boolean)</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#isaccessible" class="sidebar-link">isAccessible</a></li><li class="sidebar-sub-header"><a href="/java/baseJava/反射.html#setaccessible-accessibleobject-boolean" class="sidebar-link">setAccessible(AccessibleObject[] , boolean)</a></li></ul></li></ul></li><li><a href="/java/baseJava/接口和Lambda和内部类.html" class="sidebar-link">接口和Lambda和内部类</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="反射"><a href="#反射" class="header-anchor">#</a> 反射</h1> <p>反射是一个可以用来<strong style="color:#3EAF7C;">分析类能力</strong>的工具集，通过反射可以编写出动态操纵 Java 代码的程序。反射机制可以用来：</p> <ul><li>在运行时分析类的能力，因为 <code>Class</code> 类封装了类的运行时信息</li> <li>在运行时查看对象</li> <li>实现通用的数组操作代码</li> <li>利用 Method 对象，调用函数。</li></ul> <h2 id="class-类"><a href="#class-类" class="header-anchor">#</a> Class 类</h2> <p>在<strong style="color:#3EAF7C;">程序运行期间</strong>，Java 运行时系统始终为<strong style="color:#3EAF7C;">所有的对象</strong>维护一个被称为运行时的类型标识。这个信息跟踪着每个对象所属的类，JVM 就是通过这些信息来执行对应的方法的。</p> <p>另外，还可以通过专门 Java 类来访问这些信息，这个类就是 <code>Class</code> ，它专门用来保存类的运行时信息。</p> <h3 id="获取-class-对象"><a href="#获取-class-对象" class="header-anchor">#</a> 获取 Class 对象</h3> <p>有三种方式可以获取到 Class 对象实例，分别是：</p> <ul><li><code>obj.getClass()</code></li> <li><code>Class.forName()</code></li> <li><code>类名.class</code></li></ul> <h3 id="class-forname"><a href="#class-forname" class="header-anchor">#</a> Class.forName</h3> <p><code>Class.forName(String className)</code> ,这是 Class 类的一个静态方法，通过提供一个字符串来获取 Class 对象，例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;java.util.Random&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">错误情况</p> <p>当提供的 <code>name</code> 不是类名或接口名时，会报 checkedException 检查时异常</p></div> <h3 id="getclass-和-class"><a href="#getclass-和-class" class="header-anchor">#</a> getClass() 和 .class</h3> <p>这两种方法都可以获取到 <code>Class</code> 对象，不过会有一些区别。</p> <p>首先，我们需要知道，当调用某个类/接口/数组 C 的 <code>.class</code> 操作时，得到的是一个 <code>Class&lt;C&gt;</code> 的类对象</p> <blockquote><p>The type of C.class, where C is the name of a class, interface, or array type (§4.3), is Class&lt;C&gt;.</p></blockquote> <p>但是当调用 <code>getClass</code> 方法时，获取到的 Class 对象是 <code>Class&lt;? extends |T|&gt;</code> 。即该 Class 对象是一个属于类 T 或其子类的类对象。</p> <blockquote><p>The type of a method invocation expression of getClass is Class&lt;? extends |T|&gt;, where T is the class or interface that was searched for getClass (§15.12.1) and |T| denotes the erasure of T (§4.6).</p></blockquote> <p>具体通过下面例子来理解一下，首先存在这么两个类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Doctor</span> <span class="token keyword">extends</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>然后编写一个测试方法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Doctor</span> doctor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Doctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>doctor<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// code 1</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// code 2</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>doctor<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// code 3 ，compiler error！！</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>其中只有 <code>code1</code> 、<code>code2</code> 能正常执行，而 <code>code3</code> 会编译错误。这是因为对于操作符 <code>==</code> ，存在这样的限制：</p> <blockquote><p>It is a compile-time error if it is impossible to convert the type of either operand to the type of the other by a casting conversion (§5.5). The run-time values of the two operands would necessarily be unequal (ignoring the case where both values are null).</p></blockquote> <p>接着分析一下三段 Code 比较的是什么类型，是否能转换：</p> <ul><li><code>doctor.getClass()</code> 得到的是 <code>Class&lt;? extends Doctor&gt;</code> , 而 <code>new Employee().getClass()</code> 得到的是 <code>Class&lt;? extends Employee&gt;</code> ，其中 Doctor 类型可以通过强制转换转为父类对象，因为 Employee 有可能也是 Doctor。</li> <li><code>employee.getClass()</code> 得到的是 <code>Class&lt;? extends Employee&gt;</code>, 而 <code>Employee.class</code> 得到的是 <code>Class&lt;Employee&gt;</code>, 与上面的同理</li> <li><code>doctor.getClass()</code> 得到的是 <code>Class&lt;? extends Doctor&gt;</code>，而 <code>Employee.class</code> 得到的是 <code>Class&lt;Employee&gt;</code>，它们之间无法做任何的强制转换，因为<code>Class&lt;? extends Doctor&gt;</code>有可能是 <code>Class&lt;Doctor&gt;</code> 或者 <code>Class&lt;Surgeon&gt;</code> ，但不可能是 <code>Class&lt;Employee&gt;</code>，因为 <code>Employee</code> 并不是 Doctor 的子类。所以编译器会发生编译错误，因为这样的比较是没有意义的，百分百错误的。</li></ul> <p>如果需要第三个案例也通过，可以在调用 <code>getClass</code> 之前，先将 <code>doctor</code> 对象，强转为 <code>Employee</code> 对象 ：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span>doctor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但是这个是没有意义的。</p> <h3 id="获取类的名称"><a href="#获取类的名称" class="header-anchor">#</a> 获取类的名称</h3> <p>可以通过 Class 对象实例的 <code>getName</code> 方法获取到完整的带有包名的类名。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Random</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> cName <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// cName is set to &quot;java.util.Random&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="通过class实例创建对象"><a href="#通过class实例创建对象" class="header-anchor">#</a> 通过Class实例创建对象</h3> <p>这个方法比较常用，叫做 <code>newInstance</code> ，它可以动态的创建一个类的实例，例如 ：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样就可以创建一个与对象 <code>e</code> 具有相同类型的实例，<strong style="color:#3EAF7C;">该方法调用默认的构造器，因此如果类中没有提供默认的构造器，则会报出异常</strong>。</p> <p>通常可以结合 <code>forName</code> 使用：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> cname <span class="token operator">=</span> <span class="token string">&quot;java.util.Random&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Random</span> r <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>cname<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="class-常用api"><a href="#class-常用api" class="header-anchor">#</a> Class 常用API</h2> <p>API查询： https://docs.oracle.com/javase/8/docs/api/</p> <h3 id="getfield"><a href="#getfield" class="header-anchor">#</a> getField</h3> <p><code>getField</code> 返回一个包含Field对象的数组 <code>Field[]</code>，并且返回的都是 <code>public</code> 的域。</p> <ul><li>如果没有 <code>public</code> 域，则此方法返回长度为0的数组</li> <li>如果此Class对象表示一个类，则此方法返回该类及其所有超类的<code>Public</code> 域。</li> <li>如果此Class对象表示 <code>数组类型</code>， <code>基本数据类型</code> 或 <code>void</code> ，则此方法返回长度为0的数组。</li></ul> <h3 id="getfiled-name"><a href="#getfiled-name" class="header-anchor">#</a> getFiled(name)</h3> <p><code>Filed getFiled(name)</code> : 返回给定名称的公有域</p> <h3 id="getdeclaredfields"><a href="#getdeclaredfields" class="header-anchor">#</a> getDeclaredFields</h3> <p><code>getDeclareFields</code> 返回一个 Field 数组 <code>Field[]</code>。这包括公共，受保护，默认（程序包）访问和私有字段，但不包括继承的字段。</p> <h3 id="getdeclaredfield-name"><a href="#getdeclaredfield-name" class="header-anchor">#</a> getDeclaredField(name)</h3> <p><code>Filed getDeclaredField(name)</code> : 返回给定名称的域</p> <h3 id="getmethod"><a href="#getmethod" class="header-anchor">#</a> getMethod</h3> <p>该方法可以获取指定方法的 <code>Method</code> 对象 ：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Method</span> <span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> parameterType<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>例如要获取 <code>Employee</code> 的 <code>setName</code> 方法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Method</span> method <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;setName&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="getmethods"><a href="#getmethods" class="header-anchor">#</a> getMethods</h3> <p>返回包含 Method 对象的数组 , 返回所有的 <code>public</code> 方法，包括父类的。</p> <h3 id="getdeclaremethods"><a href="#getdeclaremethods" class="header-anchor">#</a> getDeclareMethods</h3> <p>返回包含 Method 对象的数组 , 返回这个类的或接口的全部方法，不包括继承的。</p> <h3 id="getconstructors"><a href="#getconstructors" class="header-anchor">#</a> getConstructors</h3> <p>返回包含 Constructor 对象的数组：</p> <p><code>Constructor[] getConstructors</code>： 返回 Class 对象所描述的类的所有 <code>public</code> 构造器</p> <h3 id="getdeclaredconstructors"><a href="#getdeclaredconstructors" class="header-anchor">#</a> getDeclaredConstructors</h3> <p><code>Constructor[] getDeclaredConstructors</code> ：返回Class 对象所描述的类的所有构造器</p> <h3 id="invoke"><a href="#invoke" class="header-anchor">#</a> invoke 💥</h3> <p>这个方法可以用来调用 Method 对象对应的方法，并返回方法的返回值，对于静态方法，隐式参数传递 <code>null</code> ，如果返回类型是基本类型，<code>invoke</code> 则会返回其包装类</p> <p>方法签名如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，<code>obj</code> 是隐式参数，<code>args</code> 是显式参数。</p> <h2 id="field-常用api"><a href="#field-常用api" class="header-anchor">#</a> Field 常用API</h2> <h3 id="get-obj"><a href="#get-obj" class="header-anchor">#</a> get(obj)</h3> <p>方法签名： <code>Object get(Object obj)</code> ，用来获取这个域对象在 <code>obj</code> 中对应的值。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">&quot;mike&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Field</span> field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> val <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="set-object-newvalue"><a href="#set-object-newvalue" class="header-anchor">#</a> set(Object , newValue)</h3> <p>方法签名 ： <code>void set(Object object, Object newValue)</code>, 通过这个方法，可以给对象 <code>object</code> 对应的域设置一个新值。</p> <p>最终得到的对象 <code>val</code> 的值就是 <code>mike</code> 了。</p> <h2 id="method-常用api"><a href="#method-常用api" class="header-anchor">#</a> Method 常用API</h2> <h3 id="getexceptiontype"><a href="#getexceptiontype" class="header-anchor">#</a> getExceptionType</h3> <p>返回一个用于描述方法抛出的异常类型的 Class 对象数组。<strong style="color:#3EAF7C;">意思就是，返回这个异常对应的 Class 对象，但是因为异常可能抛出多个，所以返回一个数组。</strong></p> <h3 id="getreturntype"><a href="#getreturntype" class="header-anchor">#</a> getReturnType</h3> <p>方法签名： <code>Class getReturnType</code> : 获取这个方法的返回值类型对应的 Class 对象。</p> <h3 id="getparametertypes"><a href="#getparametertypes" class="header-anchor">#</a> getParameterTypes</h3> <p>方法签名： <code>Class[] getParameterTypes</code> :返回参数类型对应的 Class 数组。</p> <h2 id="constructor-常用api"><a href="#constructor-常用api" class="header-anchor">#</a> Constructor 常用API</h2> <h3 id="getexceptiontype-2"><a href="#getexceptiontype-2" class="header-anchor">#</a> getExceptionType</h3> <p>返回一个用于描述方法抛出的异常类型的 Class 对象数组。<strong style="color:#3EAF7C;">意思就是，返回这个异常对应的 Class 对象，但是因为异常可能抛出多个，所以返回一个数组。</strong></p> <h2 id="域、方法、构造器通用-api"><a href="#域、方法、构造器通用-api" class="header-anchor">#</a> 域、方法、构造器通用 API</h2> <h3 id="getdeclaringclass"><a href="#getdeclaringclass" class="header-anchor">#</a> getDeclaringClass</h3> <p>方法签名： <code>Class getDeclaringClass</code> , 返回这个域所属的 Class 对象</p> <h3 id="getname"><a href="#getname" class="header-anchor">#</a> getName</h3> <p>方法签名： <code>String getName</code>，返回一个描述构造器、方法或域名的字符串。</p> <ul><li>域： 返回属性的名称</li> <li>方法： 返回方法的名称</li> <li>构造器： 返回构造器的名称</li></ul> <h3 id="getmodifiers"><a href="#getmodifiers" class="header-anchor">#</a> getModifiers()</h3> <p>方法签名 :<code>int getModifiers</code> ,返回一个用来描述构造器、方法、域的修饰符的整形数值。即通过它可以知道这三种元素被哪些关键字修饰，例如 <code>public</code>、<code>final</code>、<code>static</code></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Class 对象也可以使用这个方法</p></div> <h2 id="modifiers-api"><a href="#modifiers-api" class="header-anchor">#</a> Modifiers API</h2> <p>这些方法全部都是静态方法，可以直接通过类名调用</p> <h3 id="tostring"><a href="#tostring" class="header-anchor">#</a> toString</h3> <p>返回一个组合了 <code>private</code> 、<code>public</code>、<code>static</code>、<code>final</code>等等的一个字符串，具体返回哪个，根据 <code>getModifiers</code> 方法返回的整形数值运算得出。</p> <h3 id="isxxx"><a href="#isxxx" class="header-anchor">#</a> isXXX</h3> <p>这里的 <code>XXX</code> 就是对对应的关键字，包括：</p> <ul><li><code>boolean isAbstract(int modifiers)</code></li> <li><code>boolean isStatic(int modifiers)</code></li> <li><code>boolean isFinal(int modifiers)</code></li> <li><code>boolean isInterface(int modifiers)</code></li> <li><code>boolean isNative(int modifiers)</code></li> <li><code>boolean isPublic(int modifiers)</code></li> <li><code>boolean isPrivate(int modifiers)</code></li> <li><code>boolean isProtected(int modifiers)</code></li> <li><code>boolean isStrict(int modifiers)</code></li> <li><code>boolean isSynchronized(int modifiers)</code></li> <li><code>boolean isVolatile(int modifiers)</code></li></ul> <p>这些方法将检测方法名中对应的修饰符是否有包含，包含则返回 true。</p> <h2 id="accessibleobject-api"><a href="#accessibleobject-api" class="header-anchor">#</a> AccessibleObject API</h2> <p><code>AccessibleObject</code> 类是 <code>Field</code>、<code>Method</code> 和 <code>Constructor</code> 对象的基类。它提供了将反射的对象标记为在<strong style="color:#3EAF7C;">使用时取消默认 Java 语言访问控制检查的能力</strong>。对于公共成员、默认（打包）访问成员、受保护成员和私有成员，在分别使用 <code>Field</code>、<code>Method</code> 或 <code>Constructor</code> 对象来设置或获得字段、调用方法，或者创建和初始化类的新实例的时候，会执行访问检查。</p> <p>在反射对象中设置 accessible 标志允许具有足够特权的复杂应用程序（比如 Java Object Serialization 或其他持久性机制）以某种通常禁止使用的方式来操作对象。</p> <p>因此，实际上setAccessible是启用和禁用访问安全检查的开关,并不是为true就能访问为false就不能访问。由于JDK的安全检查耗时较多.所以通过setAccessible(true)的方式关闭安全检查就可以达到提升反射速度的目的</p> <h3 id="setaccessible-boolean"><a href="#setaccessible-boolean" class="header-anchor">#</a> setAccessible(boolean)</h3> <p>为反射对象设置可访问的标识，当传递 <code>true</code> 时，代表屏蔽 Java 语言的访问检查，使得<strong style="color:#3EAF7C;">对象的私有属性也可以被查询和设置</strong>。</p> <h3 id="isaccessible"><a href="#isaccessible" class="header-anchor">#</a> isAccessible</h3> <p>返回反射对象的可访问标志的值，可访问为 true，不可访问为 false</p> <h3 id="setaccessible-accessibleobject-boolean"><a href="#setaccessible-accessibleobject-boolean" class="header-anchor">#</a> setAccessible(AccessibleObject[] , boolean)</h3> <p>这是一个静态方法，通过传入一个 <code>AccessibleObject</code> 对象的数组，来集体设置可访问标识的快捷方法。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> <span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">AccessibleObject</span><span class="token punctuation">.</span><span class="token function">setsetAccessible</span><span class="token punctuation">(</span>fields<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这样就可以批量设置全部访问权限为 <code>true</code></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2020-2-26 9:02:26 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java/baseJava/继承.html" class="prev">
        继承
      </a></span> <span class="next"><a href="/java/baseJava/接口和Lambda和内部类.html">
        接口和Lambda和内部类
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.78cba7d9.js" defer></script><script src="/assets/js/2.b97de27f.js" defer></script><script src="/assets/js/28.aca93b2e.js" defer></script>
  </body>
</html>
