(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{229:function(a,e,o){"use strict";o.r(e);var r=o(28),t=Object(r.a)({},(function(){var a=this,e=a.$createElement,o=a._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[o("h1",{attrs:{id:"kafka-介绍"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#kafka-介绍"}},[a._v("#")]),a._v(" Kafka 介绍")]),a._v(" "),o("p",[a._v("Kafka 是由 Apache 开发的一款快速、可伸缩、持久且具有容错能力的发布-订阅消息系统。与其他消息系统（RocketMQ、RabbitMQ）相比，Kafka 的高吞吐率是它最大的一个特点。")]),a._v(" "),o("h2",{attrs:{id:"kafka-的系统架构"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#kafka-的系统架构"}},[a._v("#")]),a._v(" kafka 的系统架构")]),a._v(" "),o("p",[a._v("kafka 由 "),o("code",[a._v("Records(记录)")]),a._v("、"),o("code",[a._v("Topics(主题)")]),a._v("、"),o("code",[a._v("Consumers(消费者)")]),a._v("、"),o("code",[a._v("Producers(生产者)")]),a._v("、"),o("code",[a._v("Brokers(中间人)")]),a._v("、"),o("code",[a._v("Logs(日志)")]),a._v("、"),o("code",[a._v("Partitions(分区)")]),a._v("还有"),o("code",[a._v("Clusters(集群)")]),a._v("组成。")]),a._v(" "),o("p",[a._v("其架构图如下：")]),a._v(" "),o("p",[o("img",{attrs:{src:"/images/kafkaArch.jpg",alt:"kafkaarch"}})]),a._v(" "),o("p",[a._v("可以看到，Kafka 的定位是一个中间消息系统，通过一个 "),o("code",[a._v("input System")]),a._v(" 输入消息给 Kafka，这个 Input System 对应了 Kafka 的使用场景，例如日志聚合、用户活动追踪、批量导入、Web 日志等。")]),a._v(" "),o("p",[a._v("当 kafka 接受到这些数据后，可以输出给一些 "),o("code",[a._v("Ouput System")]),a._v("，例如数据分析、数据库、机器学习、Dashboards、搜索索引等")]),a._v(" "),o("p",[a._v("而在中间的 "),o("code",[a._v("Apache Core Kafka")]),a._v(" 中，可以看到，Kakfa 需要依赖 Zookeeper 的一些功能。下面来讲一下 Zookeeper 在 kafka 中的作用")]),a._v(" "),o("h3",{attrs:{id:"zookeeper-for-kafka"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper-for-kafka"}},[a._v("#")]),a._v(" Zookeeper for Kafka")]),a._v(" "),o("blockquote",[o("p",[a._v("Kafka uses Zookeeper to do leadership election of Kafka Broker and Topic Partition pairs. Kafka uses Zookeeper to manage service discovery for Kafka Brokers that form the cluster. Zookeeper sends changes of the topology to Kafka, so each node in the cluster knows when a new broker joined, a Broker died, a topic was removed or a topic was added, etc. Zookeeper provides an in-sync view of Kafka Cluster configuration.")])]),a._v(" "),o("p",[a._v("在 Kafka 中，有内置好的 Zookeeper 提供我们使用，不过我们通常会使用外部的自己配置的一台 Zookeeper 服务器，它的作用如下：")]),a._v(" "),o("ul",[o("li",[a._v("Kafka 使用 Zookeeper 进行 "),o("code",[a._v("Kafka Broker")]),a._v(" 和 "),o("code",[a._v("Topic Partition Pairs")]),a._v(" 的领导选择")]),a._v(" "),o("li",[a._v("Kafka 使用 Zookeeper 管理形成集群的 "),o("code",[a._v("Kafka Broker")]),a._v(" 的服务发现")]),a._v(" "),o("li",[a._v("Zookeeper 提供了 Kafka 集群配置的同步视图 "),o("code",[a._v("ISR")])])]),a._v(" "),o("h2",{attrs:{id:"kafka-使用场景"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#kafka-使用场景"}},[a._v("#")]),a._v(" Kafka 使用场景")]),a._v(" "),o("p",[a._v("Kafka 的应用场景有很多，下面讲解一下最常用的三个场景")]),a._v(" "),o("h3",{attrs:{id:"用户追踪"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#用户追踪"}},[a._v("#")]),a._v(" 用户追踪")]),a._v(" "),o("p",[a._v("用户在网站中不同的消息活动发送到不同的消息主题中，然后可以对这些消息进行实时监测、实时处理。还可以将这些消息存入到 spark、hadoop 中")]),a._v(" "),o("h3",{attrs:{id:"日志聚合"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#日志聚合"}},[a._v("#")]),a._v(" 日志聚合")]),a._v(" "),o("p",[a._v("Kafka 最初的定位也是用来处理海量日志的，其架构图如下, 日志采集应用将日志输入到 kafka 中，日志处理应用再从 kafka 中获取日志处理。")]),a._v(" "),o("p",[o("img",{attrs:{src:"/images/kafkalog.jpg",alt:"kafkalog"}})]),a._v(" "),o("h3",{attrs:{id:"限流削锋"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#限流削锋"}},[a._v("#")]),a._v(" 限流削锋")]),a._v(" "),o("p",[a._v("对于大型秒杀活动，可以先将用户的请求存入到 kafka 中，再由秒杀处理系统读取这些请求进行处理")]),a._v(" "),o("p",[o("img",{attrs:{src:"/images/kafkapeekclipping.png",alt:"kafkapeekclipping"}})]),a._v(" "),o("h2",{attrs:{id:"kakfa-的高吞吐率实现"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#kakfa-的高吞吐率实现"}},[a._v("#")]),a._v(" Kakfa 的高吞吐率实现")]),a._v(" "),o("p",[a._v("上面我们说过，Kafka 对比其他的消息系统来说，最大的特点就是 "),o("strong",[a._v("“高吞吐率”")]),a._v("，但是 kafka 存储数据却是存在低速硬盘上的，所以必定在 I/O 方面是很慢的，那么为什么 kafka 还会具备这样的特性呢？原因有四点：")]),a._v(" "),o("ol",[o("li",[a._v("零拷贝：kafka中的生产者和消费者 是通过 "),o("code",[a._v("Zero Copy")]),a._v(" 来操作数据的")]),a._v(" "),o("li",[a._v("顺序读写：kafka 将消息存储在分区 "),o("code",[a._v("partition")]),a._v(" 中，而分区中的消息是按顺序存放的。")]),a._v(" "),o("li",[a._v("批量添加：kafka 对消息会先进行一个缓存，当到达一定大小后，才会接受到 "),o("code",[a._v("broker")]),a._v(" 中")]),a._v(" "),o("li",[a._v("数据压缩：因为可以批量处理，所以可以对消息进行更好的压缩")])])])}),[],!1,null,null,null);e.default=t.exports}}]);