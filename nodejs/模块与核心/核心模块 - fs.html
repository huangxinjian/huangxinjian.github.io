<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>核心模块 - fs | HuangXinJian</title>
    <meta name="description" content="If you learn, learn deeply please!">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/H.png">
    
    <link rel="preload" href="/assets/css/0.styles.77838d5e.css" as="style"><link rel="preload" href="/assets/js/app.78cba7d9.js" as="script"><link rel="preload" href="/assets/js/2.b97de27f.js" as="script"><link rel="preload" href="/assets/js/40.80a7f1c2.js" as="script"><link rel="prefetch" href="/assets/js/10.5a39f9cf.js"><link rel="prefetch" href="/assets/js/11.fc6bddf2.js"><link rel="prefetch" href="/assets/js/12.da1eaab3.js"><link rel="prefetch" href="/assets/js/13.3e791f4e.js"><link rel="prefetch" href="/assets/js/14.5953a388.js"><link rel="prefetch" href="/assets/js/15.b9e792e3.js"><link rel="prefetch" href="/assets/js/16.14be3228.js"><link rel="prefetch" href="/assets/js/17.d8c48abe.js"><link rel="prefetch" href="/assets/js/18.c1171d86.js"><link rel="prefetch" href="/assets/js/19.687638f3.js"><link rel="prefetch" href="/assets/js/20.dbb7c712.js"><link rel="prefetch" href="/assets/js/21.fcac9d7b.js"><link rel="prefetch" href="/assets/js/22.05c89a82.js"><link rel="prefetch" href="/assets/js/23.6f455ef9.js"><link rel="prefetch" href="/assets/js/24.a5f5dd42.js"><link rel="prefetch" href="/assets/js/25.ddacf5f1.js"><link rel="prefetch" href="/assets/js/26.1dbabccd.js"><link rel="prefetch" href="/assets/js/27.4d3ddddd.js"><link rel="prefetch" href="/assets/js/28.aca93b2e.js"><link rel="prefetch" href="/assets/js/29.4e592fcf.js"><link rel="prefetch" href="/assets/js/3.8c3b122e.js"><link rel="prefetch" href="/assets/js/30.07e05cf0.js"><link rel="prefetch" href="/assets/js/31.4bc393d7.js"><link rel="prefetch" href="/assets/js/32.5bed9ede.js"><link rel="prefetch" href="/assets/js/33.b1d61159.js"><link rel="prefetch" href="/assets/js/34.27c7f1f1.js"><link rel="prefetch" href="/assets/js/35.17c92a26.js"><link rel="prefetch" href="/assets/js/36.91a5ecf5.js"><link rel="prefetch" href="/assets/js/37.88c250af.js"><link rel="prefetch" href="/assets/js/38.6d72295b.js"><link rel="prefetch" href="/assets/js/39.0e585af1.js"><link rel="prefetch" href="/assets/js/4.ff5f2a88.js"><link rel="prefetch" href="/assets/js/41.defa3efa.js"><link rel="prefetch" href="/assets/js/42.70857ada.js"><link rel="prefetch" href="/assets/js/5.68065b24.js"><link rel="prefetch" href="/assets/js/6.bb2aa06c.js"><link rel="prefetch" href="/assets/js/7.f469350c.js"><link rel="prefetch" href="/assets/js/8.37ca51cf.js"><link rel="prefetch" href="/assets/js/9.68f4fa83.js">
    <link rel="stylesheet" href="/assets/css/0.styles.77838d5e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HuangXinJian</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJS" class="dropdown-title"><span class="title">NodeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nodejs/NodeJS基础/NodeJS介绍.html" class="nav-link">
  NodeJS 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/baseJava/Java 介绍.html" class="nav-link">
  Java 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/frameworkHistory/架构演变历史.html" class="nav-link">
  分布式学习路线
</a></li><li class="dropdown-item"><!----> <a href="/distributed/registerCenter/" class="nav-link">
  注册中心
</a></li><li class="dropdown-item"><!----> <a href="/distributed/messageSystem/" class="nav-link">
  消息系统
</a></li><li class="dropdown-item"><!----> <a href="/distributed/internal/" class="nav-link">
  网络框架
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/RDB/MySQL_Learn/MySQL安装.html" class="nav-link">
  MySQL
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/huangxinjian/huangxinjian.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJS" class="dropdown-title"><span class="title">NodeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nodejs/NodeJS基础/NodeJS介绍.html" class="nav-link">
  NodeJS 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/baseJava/Java 介绍.html" class="nav-link">
  Java 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/distributed/frameworkHistory/架构演变历史.html" class="nav-link">
  分布式学习路线
</a></li><li class="dropdown-item"><!----> <a href="/distributed/registerCenter/" class="nav-link">
  注册中心
</a></li><li class="dropdown-item"><!----> <a href="/distributed/messageSystem/" class="nav-link">
  消息系统
</a></li><li class="dropdown-item"><!----> <a href="/distributed/internal/" class="nav-link">
  网络框架
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/RDB/MySQL_Learn/MySQL安装.html" class="nav-link">
  MySQL
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/huangxinjian/huangxinjian.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nodejs/" class="sidebar-link">前程提要</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS 介绍</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>模块与核心</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/模块与核心/核心模块 - http.html" class="sidebar-link">核心模块 - http</a></li><li><a href="/nodejs/模块与核心/核心模块 - fs.html" class="active sidebar-link">核心模块 - fs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件常识" class="sidebar-link">文件常识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#权限位-mode" class="sidebar-link">权限位 Mode</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#标志位-flag" class="sidebar-link">标志位 flag</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件描述符-fs" class="sidebar-link">文件描述符 fs</a></li></ul></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件操作" class="sidebar-link">文件操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件读取" class="sidebar-link">文件读取</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件写入" class="sidebar-link">文件写入</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件追加" class="sidebar-link">文件追加</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件拷贝" class="sidebar-link">文件拷贝</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#删除文件" class="sidebar-link">删除文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件高级操作" class="sidebar-link">文件高级操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件打开-open" class="sidebar-link">文件打开 open</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件读取-read" class="sidebar-link">文件读取 read</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件写入-write" class="sidebar-link">文件写入 write</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#文件关闭-fs-close" class="sidebar-link">文件关闭-fs.close</a></li></ul></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#目录文件夹操作" class="sidebar-link">目录文件夹操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#创建目录" class="sidebar-link">创建目录</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#删除目录" class="sidebar-link">删除目录</a></li><li class="sidebar-sub-header"><a href="/nodejs/模块与核心/核心模块 - fs.html#读取目录" class="sidebar-link">读取目录</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>异步和流程</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="核心模块-fs"><a href="#核心模块-fs" class="header-anchor">#</a> 核心模块 - fs</h1> <blockquote><p>本文参考 https://juejin.im/post/5d3f1664e51d4561a34618c1</p></blockquote> <p>对于任何编程语言来说，文件操作都是必须要学习的一个内容，在 <code>NodeJs</code> 中，文件操作等相关 API 被封装到了 <code>fs</code> 模块中，它提供了文件读取、写入、更名、删除、遍历目录、链接等 <code>POSIX</code> 文件系统操作。</p> <p>与其它模块不同的是，fs 模块中所有的操作都提供了异步和同步的两个版本,具有</p> <ul><li><code>sync</code> 后缀的方法为同步方法</li> <li>不具有 <code>sync</code> 后缀的方法为异步方法。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>POSIX 是一套文件接口的标准，有点类似于 SLF4J</p></div> <p>下面来详细学习一下这个模块的内容。</p> <h2 id="文件常识"><a href="#文件常识" class="header-anchor">#</a> 文件常识</h2> <p>在 Linux 中，文件具有三种主要特性：</p> <ul><li>权限位 <code>mode</code></li> <li>标识符 <code>flag</code></li> <li>文件描述符 <code>fd</code></li></ul> <h3 id="权限位-mode"><a href="#权限位-mode" class="header-anchor">#</a> 权限位 Mode</h3> <p>每个文件针对不同的角色都具有不同的权限，这是 <code>linux</code> 的特点，而文件权限一共有三种：</p> <p><img src="/images/node_fileauthor.png" alt="文件权限"></p> <p>可以看到，角色一共有三种：</p> <ul><li>文件拥有者（自己）</li> <li>文件所属组（家人）</li> <li>其他用户（陌生人）</li></ul> <p>文件操作权限又有三种：</p> <ul><li><code>r</code> 表示可读，对应的八进制是 4</li> <li><code>w</code> 表示可写，对应的八进制是 2</li> <li><code>x</code> 表示可执行，对应的八进制是 1</li> <li>无权限则为 0</li></ul> <p>可以通过 <code>ls -la</code> 查看文件和文件夹的所属权限：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>drwxr-xr-x <span class="token number">1</span> huangxinjian <span class="token number">197121</span>       <span class="token number">0</span>  <span class="token number">3</span>月  <span class="token number">4</span> <span class="token number">16</span>:41  Desktop/
-rw-r--r-- <span class="token number">1</span> huangxinjian <span class="token number">197121</span>      <span class="token number">41</span>  <span class="token number">3</span>月 <span class="token number">14</span>  <span class="token number">2019</span>  doc2any.ini
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第一位 <code>d</code> 和 <code>-</code> 代表的是目录和文件的意思。而后面九位就代表当前用户、用户所属组和其他用户的权限位，按每三位划分，分别代表读（r）、写（w）和执行（x），- 代表没有当前位对应的权限。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>权限参数 mode 主要针对 Linux 和 Unix 操作系统，Window 的权限默认是可读、可写、不可执行，所以权限位数字表示为 0o666，转换十进制表示为 438。</p></div> <h3 id="标志位-flag"><a href="#标志位-flag" class="header-anchor">#</a> 标志位 flag</h3> <p>Node.js 中，标识位代表着对文件的操作方式，如可读、可写、即可读又可写等等，在下面用一张表来表示文件操作的标识位和其对应的含义。</p> <table><thead><tr><th>符号</th> <th>含义</th></tr></thead> <tbody><tr><td>r</td> <td>读取文件，如果文件不存在则抛出异常。</td></tr> <tr><td>r+</td> <td>读取并写入文件，如果文件不存在则抛出异常。</td></tr> <tr><td>rs</td> <td>读取并写入文件，指示操作系统绕开本地文件系统缓存。</td></tr> <tr><td>w</td> <td>写入文件，文件不存在会被创建，存在则清空后写入。</td></tr> <tr><td>wx</td> <td>写入文件，排它方式打开。</td></tr> <tr><td>w+</td> <td>读取并写入文件，文件不存在则创建文件，存在则清空后写入。</td></tr> <tr><td>wx+</td> <td>和 w+ 类似，排他方式打开。</td></tr> <tr><td>a</td> <td>追加写入，文件不存在则创建文件。</td></tr> <tr><td>ax</td> <td>与 a 类似，排他方式打开。</td></tr> <tr><td>a+</td> <td>读取并追加写入，不存在则创建。</td></tr> <tr><td>ax+</td> <td>与 a+ 类似，排他方式打开。</td></tr></tbody></table> <p>上面表格就是这些标识位的具体字符和含义，但是 flag 是不经常使用的，不容易被记住，所以在下面总结了一个加速记忆的方法。</p> <ul><li>r：读取</li> <li>w：写入</li> <li>s：同步</li> <li>+：增加相反操作</li> <li>x：排他方式</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>r+ 和 w+ 的区别，当文件不存在时，r+ 不会创建文件，而会抛出异常，但 w+ 会创建文件；如果文件存在，r+ 不会自动清空文件，但 w+ 会自动把已有文件的内容清空。</p></div> <h3 id="文件描述符-fs"><a href="#文件描述符-fs" class="header-anchor">#</a> 文件描述符 fs</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>操作系统会为每个打开的文件标识一个文件描述符用来追踪这个文件的状态，而 Linux 和 Window 下用的不是同一种描述符，因此，NodeJs 对此进行了一层抽象封装来消除不同系统的差异，为所有打开的文件分配了数值的文件描述符。</p></div> <p>在 Node.js 中，每操作一个文件，文件描述符是递增的，文件描述符一般从 3 开始，因为前面有 0、1、2 三个比较特殊的描述符，分别代表</p> <ul><li>process.stdin（标准输入）</li> <li>process.stdout（标准输出）</li> <li>process.stderr（错误输出）</li></ul> <h2 id="文件操作"><a href="#文件操作" class="header-anchor">#</a> 文件操作</h2> <p>下面详细介绍一些有关文件的一些 api 操作</p> <h3 id="文件读取"><a href="#文件读取" class="header-anchor">#</a> 文件读取</h3> <p>文件读取需要使用 <code>fs.readFile(filename,[encoding],[callback(error,data)]</code> 方法</p> <p>文件读取函数参数介绍：</p> <ol><li>必选参数 <code>filename</code> ，表示读取的文件名。</li> <li><code>encoding</code> 是可选的，表示文件字符编码。</li> <li><code>callback</code> 是回调函数，用于接收文件的内容。</li></ol> <blockquote><p>说明：如果不指定 <code>encoding</code> ，则 <code>callback</code> 就是第二个参数。回调函数提供两个参数 <code>err</code> 和 <code>data</code> ， <code>err</code> 表示有没有错误发生，<code>data</code> 是文件内容。如果指定 <code>encoding</code> ， <code>data</code>是一个解析后的字符串，否则将会以 <code>Buffer</code> 形式表示的二进制数据。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'1.txt'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> filePath1 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'2.txt'</span><span class="token punctuation">)</span>

<span class="token comment">// -- 异步读取文件</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'asyc'</span> <span class="token operator">+</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 同步读</span>
<span class="token keyword">const</span> fileResult <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileResult<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="文件写入"><a href="#文件写入" class="header-anchor">#</a> 文件写入</h3> <p>文件写入需要使用 <code>fs.writeFile(filePath, fileData, [option], function(err)</code> 方法</p> <p>文件写入操作</p> <ol><li>第一个必选参数 filename ，表示读取的文件名</li> <li>第二个参数要写的数据</li> <li>第三个参数 option 是一个对象，如下</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>encoding <span class="token punctuation">{</span>String <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">}</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'utf-8'</span>
mode <span class="token punctuation">{</span>Number<span class="token punctuation">}</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token number">438</span><span class="token punctuation">(</span>aka <span class="token number">0666</span> <span class="token keyword">in</span> Octal<span class="token punctuation">)</span>
flag <span class="token punctuation">{</span>String<span class="token punctuation">}</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'w'</span>

<span class="token punctuation">{</span>
  <span class="token string">'encoding'</span><span class="token operator">:</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span>
  <span class="token string">'mode'</span><span class="token operator">:</span> <span class="token number">438</span><span class="token punctuation">,</span>
  <span class="token string">'flag'</span><span class="token operator">:</span> <span class="token string">'w'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>其中：</p> <ul><li><code>mode</code>: 438 是十进制，转换为八进制是 <code>0666</code></li> <li><code>flag</code>值，默认为 <code>w</code>,会清空文件，然后再写。</li> <li><code>flag</code>值，<code>r</code>代表读取文件，<code>w</code>代表写文件，<code>a</code>代表追加。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 写入文件内容（如果文件不存在会创建一个文件）</span>
<span class="token comment">// 写入时会先清空文件</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'写入成功：程序员成长指北'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 写入成功后读取测试</span>
  <span class="token keyword">var</span> data<span class="token operator">=</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'new data --&gt;'</span><span class="token operator">+</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过文件写入并且利用flag也可以实现文件追加</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'程序员成长指北追加的数据'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'flag'</span><span class="token operator">:</span><span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> data<span class="token operator">=</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token comment">// 写入成功后读取测试</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'追加后的数据 --&gt;'</span><span class="token operator">+</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="文件追加"><a href="#文件追加" class="header-anchor">#</a> 文件追加</h3> <p>文件追加使用方法 <code>fs.appendFile(filename, data, [options], callback)</code>，<strong style="color:#3EAF7C;">该方法以异步的方式将 data 插入到文件里，如果文件不存在会自动创建</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>其实就是注入了<code>[options]</code>的 <code>flag</code> 默认值是 <code>”a”</code>，所以它以追加方式写入数据.</p></div> <p>参数说明：</p> <ol><li>第一个必选参数 filename ，表示读取的文件名</li> <li>第二个参数 data，data 可以是任意字符串或者缓存</li> <li>第三个参数 option 是一个对象，可配置与 <code>write</code> 一致</li></ol> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// -- 异步另一种文件追加操作(非覆盖方式)</span>
<span class="token comment">// 写入文件内容（如果文件不存在会创建一个文件）</span>
fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'异步追加数据'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 写入成功后读取测试</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// -- 同步另一种文件追加操作(非覆盖方式)</span>
fs<span class="token punctuation">.</span><span class="token function">appendFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'追加数据同步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="文件拷贝"><a href="#文件拷贝" class="header-anchor">#</a> 文件拷贝</h3> <p>文件拷贝通过 <code>fs.copyFile(filenameA, filenameB，callback)</code> 调用，参数说明：</p> <ol><li>第一个参数原始文件名</li> <li>第二个参数要拷贝到的文件名</li> <li>回调</li></ol> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 将filePath文件内容拷贝到filePath1文件内容</span>
fs<span class="token punctuation">.</span><span class="token function">copyFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> filePath1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath1<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 程序员成长指北</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="删除文件"><a href="#删除文件" class="header-anchor">#</a> 删除文件</h3> <p>文件删除使用 <code>fs.unlink(filename, callback)</code> 调用，参数说明：</p> <ol><li>第一个参数文件路径</li> <li>第二个回调函数 callback</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// -- 异步文件删除</span>
fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -- 同步删除文件</span>
fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="文件高级操作"><a href="#文件高级操作" class="header-anchor">#</a> 文件高级操作</h2> <p>上面的文件操作都是一步到位的，例如一次性就把整个文件读完或者一次性就把数据全部写进文件了，不能说我就想读文件的第三个位置开始的内容，因此 NodeJs 提供了一些文件 api 的高级操作。</p> <p>流程如下：</p> <ol><li>先用 <code>fs.open</code> 来打开文件</li> <li>然后才可以用 <code>fs.read</code> 去读，或者用 <code>fs.write</code> 去写文件</li> <li>最后，你需要用 <code>fs.close</code> 去关掉文件。</li></ol> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>特殊说明：read 方法与 readFile 不同，一般针对于文件太大，无法一次性读取全部内容到缓存中或文件大小未知的情况，都是多次读取到 Buffer 中。</p></div> <h3 id="文件打开-open"><a href="#文件打开-open" class="header-anchor">#</a> 文件打开 open</h3> <p>文件打开通过 <code>fs.open(path,flags,[mode],callback)</code> 调用，参数说明：</p> <ol><li>第一个参数:文件路径</li> <li>第二个参数:与开篇说的标识符 flag 相同</li> <li>第三个参数:[mode] 是文件的权限（可选参数，默认值是0666）</li> <li>第四个参数:callback 回调函数</li></ol> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'0666'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>fd</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'哈哈哈'</span><span class="token punctuation">,</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回的第二个参数为一个整数，表示打开文件返回的文件描述符，window中又称文件句柄</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意，下面的方法包括这个方法都有对应的同步版本，例如 <code>fs.openSync</code></p></div> <h3 id="文件读取-read"><a href="#文件读取-read" class="header-anchor">#</a> 文件读取 read</h3> <p>文件读取通过方法 <code>fs.read(fd, buffer, offset, length, position, callback);</code> ，参数说明如下：</p> <ol><li><code>fd</code>：文件描述符，需要先使用 <code>open</code> 打开，使用 <code>fs.open</code> 打开成功后返回的文件描述符；</li> <li><code>buffer</code>：一个 Buffer 对象，v8引擎分配的一段内存，要将内容读取到的 Buffer；</li> <li><code>offset</code>：整数，向 Buffer 缓存区写入的初始位置，以字节为单位；</li> <li><code>length</code>：整数，读取文件的长度；</li> <li><code>position</code>：整数，读取文件初始位置；文件大小以字节为单位</li> <li><code>callback</code>：回调函数，在读取执行完成后执行</li></ol> <p>最后的回调函数有三个参数，</p> <ol><li>err（错误）</li> <li>bytesRead（实际读取的字节数）</li> <li>buffer（被写入的缓存区对象），即本次操作读入的内容就会在 buffer 中，<strong style="color:#3EAF7C;">这个buffer与上面参数2的buffer不同</strong>。</li></ol> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 创建6字节长度的buf缓存对象</span>

<span class="token comment">// 打开文件</span>
fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'1.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 读取文件，</span>
  <span class="token comment">// 从buf第0个位置开始存，一次读1.txt文件的3个字节，从1.txt文件的第0个字节的位置开始读</span>
  fs<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> bytesRead<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 继续读取，</span>
    <span class="token comment">// 从buf第3个位置开始存，一次读1.txt文件的3个字节，从1.txt文件的第3个字节的位置开始读</span>
    fs<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> bytesRead<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3</span>
<span class="token comment">// &lt;Buffer e4 bd a0 00 00 00&gt;</span>

<span class="token comment">// 3</span>
<span class="token comment">// &lt;Buffer e4 bd a0 e5 a5 bd&gt;</span>
<span class="token comment">// 你好</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="文件写入-write"><a href="#文件写入-write" class="header-anchor">#</a> 文件写入 write</h3> <p>文件写入通过 <code>fs.write(fd, buffer, offset, length, position, callback);</code>，参数说明：</p> <ol><li>fd：文件描述符，使用fs.open 打开成功后返回的；</li> <li>buffer：一个 Buffer 对象，v8 引擎分配的一段内存，存储将要写入文件数据的 Buffer；</li> <li>offset：整数，从 Buffer 缓存区读取数据的初始位置，以字节为单位；</li> <li>length：整数，读取 Buffer 数据的字节数；</li> <li>position：整数，写入文件初始位置；</li> <li>callback：写入操作执行完成后回调函数，写入完成后执行。</li></ol> <p>最后的回调函数有三个参数，</p> <ol><li>err（错误）</li> <li>bytesWritten（实际写入的字节数）</li> <li>buffer（被读取的缓存区对象）</li></ol> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// buf 这个 buf 里面已经是通过 fs.read 读取过数据了</span>
fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'3.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'0666'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> bytesRead<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="文件关闭-fs-close"><a href="#文件关闭-fs-close" class="header-anchor">#</a> 文件关闭-fs.close</h3> <p>文件关闭通过 <code>fs.close(fd,callback)</code> 调用，参数如下：</p> <ol><li>第一个参数：fd ，文件open时传递的文件描述符</li> <li>第二个参数 callback 回调函数,回调函数有一个参数 err（错误），关闭文件后执行。</li></ol> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注意文件描述符fd</span>
fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'关闭成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 关闭成功</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="目录文件夹操作"><a href="#目录文件夹操作" class="header-anchor">#</a> 目录文件夹操作</h2> <h3 id="创建目录"><a href="#创建目录" class="header-anchor">#</a> 创建目录</h3> <p>创建目录通过 <code>fs.mkdir(path, [options], callback)</code>, 参数 option 可配置：</p> <ol><li><code>recursive</code>  默认值: false。</li> <li><code>mode</code>  Windows 上不支持。默认值: 0o777。</li></ol> <p>可选的 options 参数可以是</p> <ul><li>指定模式（权限和粘滞位）的整数</li> <li>或者是具有 mode 属性和 recursive 属性（指示是否应创建父文件夹）的<strong style="color:#3EAF7C;">对象</strong>。</li></ul> <h3 id="删除目录"><a href="#删除目录" class="header-anchor">#</a> 删除目录</h3> <p>删除目录通过 <code>fs.rmdir(path,callback)</code>，参数说明</p> <ol><li>第一个参数：path目录路径</li> <li>第三个参数回调函数,回调函数有一个参数 err（错误），关闭文件后执行</li></ol> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'./mkdir'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除目录成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>在文件（而不是目录）上使用 fs.rmdir() 会导致在 Windows 上出现 ENOENT 错误、在 POSIX 上出现 ENOTDIR 错误。</p></div> <h3 id="读取目录"><a href="#读取目录" class="header-anchor">#</a> 读取目录</h3> <p>读取目录通过 <code>fs.readdir(path, [options], callback)</code> ，第二个参数 <code>[options]</code> 是可选的，可以是<strong style="color:#3EAF7C;">指定编码的字符串</strong>，也可以是<strong style="color:#3EAF7C;">具有 encoding 属性的对象</strong>，该属性指定用于传给回调的文件名的字符编码。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果 encoding 设置为 'buffer'，则返回的文件名是 Buffer 对象。
如果 options.withFileTypes 设置为 true，则 files 数组将包含 fs.Dirent 对象。</p></div> <p>第三个参数，回调函数有两个参数，第一个 err（错误），第二个返回的 <code>data</code> 为一个数组，包含该文件夹的所有文件，是目录中的文件名的数组（不包括 <code>'.'</code> 和 <code>'..'</code>）。</p> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'./file'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token comment">//data为一个数组</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取的数据为：'</span><span class="token operator">+</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2020-3-10 10:45:11 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nodejs/模块与核心/核心模块 - http.html" class="prev">
        核心模块 - http
      </a></span> <span class="next"><a href="/nodejs/异步和流程/异步调用和流程控制.html">
        异步调用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.78cba7d9.js" defer></script><script src="/assets/js/2.b97de27f.js" defer></script><script src="/assets/js/40.80a7f1c2.js" defer></script>
  </body>
</html>
